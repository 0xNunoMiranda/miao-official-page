---
deployment:
  tasks:
    # 1) Pasta de destino no servidor (ajusta para o teu utilizador/pasta)
    - export DEPLOYPATH=/home/SEU_USER/apps/miao-official-page

    # 2) Garantir que a pasta existe
    - /bin/mkdir -p $DEPLOYPATH

    # 3) Instalar dependências (usa o package-lock.json)
    - /bin/npm ci || /bin/npm install

    # 4) Build de produção (Next.js / app do AI Studio)
    - /bin/npm run build

    # 5) Copiar tudo (código + .next + public, etc.) para a pasta de deploy
    - /bin/rsync -aP --delete-after \
        --exclude ".git" \
        --exclude ".cpanel.yml" \
        ./ $DEPLOYPATH

    # 6) (Opcional) Reiniciar a app Node, se tiveres um script/comando para isso
    # - /home/SEU_USER/apps/miao-official-page/restart.sh || true
